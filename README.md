
# 双策略波动率风险溢价捕捉系统

## 项目概述
波动率风险溢价捕捉系统是一个基于Python开发的量化交易策略框架，通过动态组合期限结构交易策略和ETF对冲策略，实现在不同市场环境下捕捉波动率风险溢价的目标。

## 功能特性
- **双策略协同**: 期限结构策略+ETF对冲策略动态组合
- **市场状态识别**: 自动识别6种市场状态并优化策略权重
- **全面分析**: 提供详细的绩效指标和市场状态分析
- **可视化展示**: 生成直观的策略表现图表
- **样本内外测试**: 支持训练集/测试集分离验证
- **参数化配置**: 所有关键参数均可配置调整

## 快速开始

* **市场状态分类框架** ：基于VIX水平、市场趋势和期限结构形态动态识别市场环境
* **策略互补性** ：期限结构策略擅长高波动环境，ETF对冲策略擅长低波动环境
* **动态策略选择** ：根据市场状态自动调整策略权重，优化风险收益特性
* **健壮的数据获取** ：实现多级缓存、自动重试和备用数据源机制
* **向量化计算** ：高效实现回测，支持大规模历史数据分析
* **全面绩效分析** ：提供详细的回测分析和丰富的可视化图表

### 安装依赖

### 运行系统
```bash
pip install pandas numpy matplotlib seaborn scipy yfinance requests
```

## 典型输出示例
```
波动率风险溢价捕捉系统
.src/
├── main.py                 # 主程序入口
├── data_fetcher.py         # 增强版数据获取模块
├── market_state.py         # 市场状态分类
├── strategies.py           # 交易策略实现
├── dynamic_selection.py    # 动态策略选择系统
├── performance.py          # 绩效评估
├── visualization.py        # 数据可视化
├── config.py               # 配置文件
└── data_cache/             # 数据缓存目录
```

## 技术支持
遇到问题时请提供:
1. `log/backtest.log`日志文件
2. 使用的参数配置
3. 问题重现步骤

更多详细信息请参考项目文档或联系我们的技术支持团队：2354889815@qq.com

```bash
python src/main.py
```

## 版权声明
© 2025 Jacky。保留所有权利。
本项目采用MIT许可证授权，详情请见项目根目录下的`LICENSE`文件。

2. **自定义回测参数**

```bash
python src/main.py --start_date 2018-01-01 --end_date 2022-12-31 --output_dir custom_results
```

3. **数据获取选项**

```bash
# 强制重新下载数据（不使用缓存）
python src/main.py --force_download

# 不使用任何缓存
python src/main.py --no_cache

# 使用本地数据文件
python src/main.py --local_file path/to/historical_data.csv
```

4. **只运行回测，不生成图表**

```bash
python src/main.py --no_plots
```

### 配置参数

系统主要参数可在 `config.py`中修改，包括：

* **回测参数** ：起止日期、交易成本、滑点等
* **数据获取参数** ：缓存设置、重试机制、备用数据源配置
* **策略参数** ：目标波动率、风险管理阈值等
* **市场状态分类参数** ：VIX阈值、期限结构阈值等
* **动态策略选择参数** ：各状态下的策略权重分配、权重调整速度等
* **日志配置** ：日志级别、输出格式和位置

### 增强版数据获取系统

我们的系统实现了一个健壮的数据获取模块，具有以下特点：

* **智能缓存机制** ：自动缓存已下载数据，避免重复请求
* **多级重试策略** ：使用指数退避算法应对网络错误，提高数据获取成功率
* **备用数据源** ：当主数据源失败时，自动切换到备用数据源
* **合成数据生成** ：在极端情况下，可生成合成数据用于测试
* **全面错误处理** ：详细的日志记录和异常处理

### 生成的分析结果

运行回测后，系统会生成以下分析结果：

1. **策略绩效指标** ：年化收益、夏普比率、最大回撤、胜率等
2. **分市场状态分析** ：各状态下的策略表现
3. **COVID-19案例分析** ：极端市场环境下的策略表现
4. **样本内外测试** ：评估策略的稳健性
5. **可视化图表** ：

* 策略累积收益对比图
* 市场状态分类图
* 分状态策略表现图
* COVID-19期间分析图
* 策略权重动态转换图
* 样本内外绩效对比图
* 收益分布图

### 注意事项

1. 本系统中VIX期货数据为基于VIX和VXX合成的模拟数据，实际应用中应使用真实的期货数据。
2. 回测考虑了交易成本、滑点和做空成本，但仍是历史模拟，实际交易效果可能有所差异。
3. 动态策略选择系统需要及时识别市场状态变化，在实际应用中可能存在滞后性。
4. 数据获取依赖外部API，可能受到访问限制或速率限制，建议合理设置缓存和重试参数。

### 系统优势

1. **自适应性** ：根据市场状态动态调整策略配置，适应不同市场环境
2. **健壮性** ：多级数据获取机制和全面的异常处理，确保系统稳定运行
3. **易扩展性** ：模块化设计使添加新策略或分析工具变得简单
4. **全面分析** ：提供深入的绩效分析和直观的可视化，便于策略评估和优化

### 拓展方向

1. **机器学习增强** ：引入机器学习方法优化市场状态识别和预测
2. **期权波动率曲面** ：纳入期权波动率曲面信息，增加策略维度
3. **实时监控系统** ：开发实时市场状态监控和信号生成系统
4. **精细风险管理** ：开发更精细的风险管理机制，特别是针对尾部风险的控制
5. **多资产整合** ：探索波动率策略与其他资产类别的组合效应
6. **实盘接口** ：增加与交易API的接口，支持实盘交易

### 性能指标

在2015-2023年的回测期间，该系统表现如下（实际结果可能因数据和参数设置而异）：

| 指标     | 期限结构策略 | ETF对冲策略 | 动态组合策略 |
| -------- | ------------ | ----------- | ------------ |
| 年化收益 | 12.5%        | 8.3%        | 15.2%        |
| 夏普比率 | 0.85         | 0.72        | 1.15         |
| 最大回撤 | -18.7%       | -15.2%      | -12.3%       |
| 胜率     | 55.3%        | 58.7%       | 57.8%        |

动态组合策略在各种市场环境下都表现出较强的稳健性，特别是在市场剧烈波动期间（如2020年COVID-19危机）展现出优异的防御性能和恢复能力。
